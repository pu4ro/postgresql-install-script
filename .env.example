# ===================================================================
# 시스템 커널 튜닝 설정 (성능 최적화)
# ===================================================================

# --- 메모리 관리 (Memory) ---
# 스왑 사용 억제 (기본값 60 -> 10, DB는 메모리에서 작동해야 빠름)
VM_SWAPPINESS=10

# Dirty Page 관리 (I/O 스파이크 방지)
VM_DIRTY_BACKGROUND_RATIO=5
VM_DIRTY_RATIO=15

# Overcommit 설정 (0=기본, 2=PostgreSQL 권장)
VM_OVERCOMMIT_MEMORY=0

# --- 네트워크 (Network) ---
# 연결 대기 큐 크기 증가 (기본값 128 -> 4096)
NET_CORE_SOMAXCONN=4096
NET_IPV4_TCP_MAX_SYN_BACKLOG=4096

# Keepalive 시간 단축 (죽은 연결 빠른 감지)
NET_IPV4_TCP_KEEPALIVE_TIME=600
NET_IPV4_TCP_KEEPALIVE_PROBES=5
NET_IPV4_TCP_KEEPALIVE_INTVL=10

# --- 공유 메모리 (Shared Memory) ---
# Huge Pages 사용 시 필요 (서버 메모리에 따라 조정)
KERNEL_SHMMAX=17179869184
KERNEL_SHMALL=4194304

# --- 리소스 제한 (ulimit) ---
# 파일 디스크립터 제한
ULIMIT_NOFILE=65536

# 프로세스 수 제한
ULIMIT_NPROC=unlimited

# 메모리 잠금 제한 (Huge Pages용)
ULIMIT_MEMLOCK=unlimited

# --- Huge Pages 설정 ---
# Huge Pages 활성화 여부 (true/false)
ENABLE_HUGE_PAGES=false

# Huge Pages 수동 설정 (자동 계산 원하면 비워두기)
# 계산법: shared_buffers / 2MB
# 예: 4GB shared_buffers = 4096MB / 2MB = 2048
HUGE_PAGES_COUNT=

# ===================================================================
# PostgreSQL 설정
# ===================================================================

PG_VERSION=16
PG_MAJOR_VERSION=16

# 경로 설정
PG_BIN_DIR=/usr/pgsql-${PG_VERSION}/bin
PG_DATA_DIR=/var/lib/pgsql/${PG_VERSION}/data
PG_SERVICE_NAME=postgresql-${PG_VERSION}

# PostgreSQL 메모리 설정 (Huge Pages 계산용)
PG_SHARED_BUFFERS=4GB

# 네트워크 설정
PG_PORT=5432
PG_LISTEN_ADDRESSES=*
# 외부 접속 허용 IP 대역 (0.0.0.0/0은 모든 IP 허용, 보안상 특정 IP로 제한 권장)
PG_ALLOWED_CIDR=0.0.0.0/0

# 인증 방식 (scram-sha-256, md5, trust 등)
PG_AUTH_METHOD=scram-sha-256

# 방화벽 설정
ENABLE_FIREWALL=true

# OS 사용자 (기본값: postgres)
PG_OS_USER=postgres

# RHEL/Rocky Linux 버전
EL_VERSION=9

# ===================================================================
# 오프라인 패키징 설정
# ===================================================================

# 오프라인 패키지 저장 경로
OFFLINE_REPO_DIR=/root/postgresql-offline-repo

# 오프라인 패키지 아카이브 이름
OFFLINE_ARCHIVE_NAME=postgresql${PG_VERSION}-offline-el${EL_VERSION}.tar.gz

# 다운로드할 PostgreSQL 특정 버전 (비워두면 최신 버전)
# 예: 16.10-1PGDG.rhel9
OFFLINE_PG_VERSION=16.10-1PGDG.rhel9

# 오프라인 repo 마운트 포인트 (설치 시)
OFFLINE_MOUNT_POINT=/mnt/postgresql-repo

# ISO 파일 경로 (RHEL/Rocky Linux 설치 ISO)
# 예: /root/rhel-9.6-x86_64-dvd.iso
ISO_FILE=

# ===================================================================
# Apache Web Server 설정
# ===================================================================

# Apache 설치 여부
INSTALL_APACHE=false

# Apache 포트
APACHE_HTTP_PORT=80
APACHE_HTTPS_PORT=443

# Apache 설정 디렉토리
APACHE_CONF_DIR=/etc/httpd/conf
APACHE_CONF_D_DIR=/etc/httpd/conf.d
APACHE_DOC_ROOT=/var/www/html

# Apache 서비스 이름
APACHE_SERVICE_NAME=httpd

# Apache 사용자
APACHE_USER=apache

# ===================================================================
# Tomcat 설정
# ===================================================================

# Tomcat 설치 여부
INSTALL_TOMCAT=false

# Tomcat 버전 (9 또는 10)
TOMCAT_MAJOR_VERSION=9

# Tomcat 포트
TOMCAT_HTTP_PORT=8080
TOMCAT_HTTPS_PORT=8443
TOMCAT_AJP_PORT=8009
TOMCAT_SHUTDOWN_PORT=8005

# Tomcat 설치 방식 (package: dnf 패키지, manual: 수동 설치)
TOMCAT_INSTALL_METHOD=package

# Tomcat 수동 설치 시 경로
TOMCAT_HOME=/opt/tomcat
TOMCAT_VERSION=9.0.96

# Tomcat 패키지 설치 시 경로
TOMCAT_BASE=/var/lib/tomcat
TOMCAT_CONF_DIR=/etc/tomcat

# Tomcat 서비스 이름
TOMCAT_SERVICE_NAME=tomcat

# Tomcat 사용자
TOMCAT_USER=tomcat

# Java 설정 (Tomcat 필요)
JAVA_HOME=/usr/lib/jvm/java-11-openjdk
